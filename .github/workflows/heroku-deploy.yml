name: Deploy to Heroku

on:
  push:
    branches:
      - heroku # deploy only on pushes to heroku (change if needed)

# Heroku deployment is automated via Heroku Git integration,
# so this workflow focuses on pre-deployment checks.
jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Syntax check Dockerfile
        run: |
          if ! docker image build --dry-run -f Dockerfile .; then
            echo "Dockerfile syntax error!"
            exit 1
          fi

      - name: Syntax check app.py
        run: |
          python3 -m py_compile app.py

      - name: Check requirements.txt for flask
        run: |
          grep -i '^flask' requirements.txt || (echo "Flask not found in requirements.txt!" && exit 1)
